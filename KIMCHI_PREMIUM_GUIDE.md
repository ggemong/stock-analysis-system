# 김치 프리미엄 기능 추가 (v1.6.4)

## 🌶️ 새로운 기능: 김치 프리미엄 체크

국내 거래소(업비트)와 해외 거래소(바이낸스)의 암호화폐 가격을 실시간 비교하여 김치 프리미엄/디스카운트를 계산하고, 이를 매매 전략에 반영합니다.

## 📊 김치 프리미엄이란?

**김치 프리미엄**은 국내 암호화폐 거래소의 가격이 해외 거래소 대비 얼마나 비싼지/저렴한지를 나타내는 지표입니다.

```
김치 프리미엄(%) = (업비트 가격(원) - 바이낸스 가격(원화 환산)) / 바이낸스 가격(원화 환산) × 100
```

### 예시
- **바이낸스**: BTC $84,000 × 환율 1,432원 = ₩120,288,000
- **업비트**: BTC ₩126,000,000
- **김치 프리미엄**: (126,000,000 - 120,288,000) / 120,288,000 × 100 = **+4.75%**

→ 국내가 해외보다 4.75% 비쌈 (프리미엄)

## 🎯 매매 전략

### 프리미엄 구간별 전략

| 김치 프리미엄 | 상태 | 신호 | 전략 |
|--------------|------|------|------|
| **+5% 이상** | 🔥 높은 프리미엄 | 국내 매도 우위 | 업비트 신규 매수 자제. 보유 중이면 매도 고려 |
| **+2% ~ +5%** | 📈 프리미엄 | 국내 약간 비쌈 | 급하지 않다면 프리미엄 하락 대기 |
| **-2% ~ +2%** | ⚖️ 균형 | 정상 범위 | 기술적 분석에 따라 정상 매매 |
| **-5% ~ -2%** | 📉 디스카운트 | 국내 약간 저렴 | 업비트 매수 기회, 분할 진입 권장 |
| **-5% 이하** | ❄️ 높은 디스카운트 | 국내 매수 우위 | 업비트 적극 매수 찬스 |

### 잼스의 암호화폐 투자 룰 (업데이트)

```
4. 암호화폐 (순수 추세 + 김치 프리미엄):
   ✅ MA20 > MA50 정배열 → 매수 가능
   ❌ 역배열 → 즉시 매수 중단
   
   추가 조건:
   - 김치 프리미엄 +5% 이상 → 신규 매수 자제
   - 김치 프리미엄 -5% 이하 → 적극 매수
   - 김치 프리미엄 -2~+2% → 정상 매매
```

## 📦 지원 암호화폐

현재 다음 5개 암호화폐의 김치 프리미엄을 체크합니다:

1. **BTC** (비트코인)
2. **ETH** (이더리움)
3. **XRP** (리플)
4. **SOL** (솔라나)
5. **ADA** (카르다노)

## 🔧 기술 구조

### 새로운 파일
- `src/collectors/kimchi_premium_collector.py`: 김치 프리미엄 수집기

### 데이터 소스
- **업비트 API**: `https://api.upbit.com/v1/ticker`
- **바이낸스 API**: `https://api.binance.com/api/v3/ticker/price`

### 데이터 흐름
```
1. 환율 수집 (ExchangeRateCollector)
   ↓
2. 업비트 가격 조회 (KRW)
   ↓
3. 바이낸스 가격 조회 (USDT)
   ↓
4. 바이낸스 가격을 원화로 환산
   ↓
5. 김치 프리미엄 계산 (%)
   ↓
6. Gemini AI 분석에 반영
```

## 📱 출력 예시

### JSON 데이터
```json
{
  "kimchi_premium": {
    "BTC": {
      "upbit_price_krw": 126000000,
      "binance_price_usd": 84024.5,
      "binance_price_krw": 120288000,
      "premium_percent": 4.75,
      "status": "프리미엄",
      "signal": "국내 약간 비쌈",
      "exchange_rate_used": 1432.53,
      "success": true
    }
  }
}
```

### 텔레그램 메시지
```
🌶️ 김치 프리미엄
📈 BTC: +4.8% (프리미엄)
❄️ ETH: -3.2% (디스카운트)
⚖️ XRP: +0.5% (균형)
```

### Gemini 프롬프트
```
### 🌶️ 김치 프리미엄 (업비트 vs 바이낸스)
- **BTC**: +4.75% 📈 (프리미엄)
  - 업비트: ₩126,000,000
  - 바이낸스: $84,024.50 (₩120,288,000)
  - 신호: 국내 약간 비쌈
```

## 🎓 활용 방법

### 1. 기본 전략
```python
# 정배열 + 김치 디스카운트 = 강력 매수
if ma20 > ma50 and kimchi_premium < -5:
    action = "업비트 적극 매수"

# 정배열 + 김치 프리미엄 = 매수 자제
if ma20 > ma50 and kimchi_premium > 5:
    action = "신규 매수 쉼, 보유분은 매도 고려"

# 역배열 = 무조건 관망
if ma20 < ma50:
    action = "추세 불량, 매수 중단"
```

### 2. 잼스의 코칭 예시

**시나리오 1: 프리미엄 구간**
```
"비트코인 김치 프리미엄이 +6.2%입니다. 
국내가 해외보다 6% 이상 비쌉니다. 
업비트 신규 매수는 쉬세요. 
정배열이지만 너무 비싸게 사는 겁니다."
```

**시나리오 2: 디스카운트 구간**
```
"이더리움 김치 디스카운트 -4.8%! 
국내가 해외보다 저렴합니다. 
정배열도 유지 중이니 업비트에서 오늘 
여유자금의 10% 추가 매수하세요."
```

## ⚠️ 주의사항

### 1. 차익거래의 한계
김치 프리미엄이 크다고 해서 무조건 차익거래가 가능한 것은 아닙니다:
- 업비트 → 바이낸스 송금 수수료
- 출금 대기 시간
- 네트워크 컨펌 시간
- 슬리피지 (가격 변동)

### 2. API 제한
- **업비트**: 분당 600회 제한
- **바이낸스**: 분당 1200회 제한 (IP별)

현재는 5개 코인만 체크하므로 문제없음.

### 3. 환율 의존성
김치 프리미엄 계산은 환율에 의존합니다. 환율 수집 실패 시 김치 프리미엄도 수집되지 않습니다.

## 🚀 사용 방법

### 자동 실행 (기본)
```bash
python main.py
```

김치 프리미엄이 자동으로 수집되어 JSON 및 텔레그램에 포함됩니다.

### 수동 테스트
```bash
cd src/collectors
python kimchi_premium_collector.py
```

## 📈 향후 개선 계획

1. **더 많은 코인 지원**: TOP 20 코인까지 확대
2. **히스토리 추적**: 김치 프리미엄 추이 그래프
3. **알림 기능**: 프리미엄 ±5% 돌파 시 즉시 알림
4. **다중 거래소**: 코인원, 빗썸 추가
5. **차익거래 계산기**: 실제 수익 시뮬레이션

## 🔄 버전 정보

- **버전**: v1.6.4
- **업데이트 날짜**: 2026-01-31
- **주요 변경사항**:
  - 김치 프리미엄 수집기 추가
  - 암호화폐 매매 전략에 김치 프리미엄 반영
  - Gemini 프롬프트 및 텔레그램 메시지에 김치 프리미엄 정보 추가

## 📚 관련 문서

- `MA200_FIX_README.md`: MA200 계산 문제 해결
- `JAMS_PERSONA_UPDATE.md`: 잼스 페르소나 업데이트
- `KIMCHI_PREMIUM_GUIDE.md`: 이 문서
